function initializeMap(){function a(){this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(0,0)}var n=MapCoordSrvc.wgs2bd(mapLatLng.lat,mapLatLng.lng),e=new BMap.Point(n.lng,n.lat);map=new BMap.Map("mapUICanvas",{enableMapClick:!1}),map.centerAndZoom(e,mapZoom),map.enableScrollWheelZoom(!0);var r=new BMap.Icon("res/img/pin_normal.png",new BMap.Size(22,38)),p=new BMap.Icon("res/img/pin_dragging_faded.png",new BMap.Size(22,38)),o=new BMap.Icon("res/img/pin_normal_faded.png",new BMap.Size(22,38));mapMarker=new BMap.Marker(e,{icon:r}),mapMarker.setOffset(new BMap.Size(0,-12)),map.addOverlay(mapMarker),mapMarker.enableDragging(),mapIsLoaded=!0,a.prototype=new BMap.Control,a.prototype.initialize=function(a){var n=$("#mapUICtl");return a.getContainer().appendChild(n[0]),n.show(),n[0]};var t=new a;map.addControl(t),mapLoaderFunc.initializeTools(),map.addEventListener("zoomend",function(){mapZoom=map.getZoom()}),mapMarker.addEventListener("mousedown",function(a){mapMarker.setIcon(o)}),mapMarker.addEventListener("dragstart",function(a){mapMarker.setIcon(p)}),mapMarker.addEventListener("mouseup",function(a){mapMarker.setIcon(r)}),mapMarker.addEventListener("dragend",function(a){var n=MapCoordSrvc.bd2wgs(a.point.lat,a.point.lng);mapLatLng.lat=n.lat,mapLatLng.lng=n.lng,mapLoaderFunc.enableEdit()})}function moveMarkerTo(a){var n=MapCoordSrvc.wgs2bd(a.lat,a.lng),e=new BMap.Point(n.lng,n.lat);mapMarker.setPosition(e),map.panTo(e)}var map,mapMarker;